<!-- templates/upload.html -->
{% extends "base.html" %}

{% block head %}{% endblock %}

{% block content %}
  <div class="page-wrapper">
    <div class="card upload-container">
      <h2>Upload Your Documents</h2>
      <p style="margin: 6px 0 16px; color: var(--muted);">PDF, DOCX, or TXT up to 16MB.</p>
      <form action="{{ url_for('upload_file') }}" method="post" enctype="multipart/form-data">
        <input class="file-input" type="file" name="file" accept=".pdf,.docx,.txt" required>
        <input type="submit" value="Upload">
      </form>
    </div>

    <div class="card manage-container">
      <h2>Manage Existing Documents</h2>
      {% if sources %}
        <form action="{{ url_for('delete_sources') }}" method="post" onsubmit="return confirmDelete();">
          <table>
            <thead>
              <tr>
                <th>Select</th>
                <th>Source Document</th>
              </tr>
            </thead>
            <tbody>
              {% for source in sources %}
              <tr>
                <td><input type="checkbox" name="sources" value="{{ source }}"></td>
                <td>{{ source }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <button type="submit" class="btn btn-danger">Delete Selected Sources</button>
        </form>
      {% else %}
        <p style="color: var(--muted);">No documents uploaded yet.</p>
      {% endif %}
    </div>
  </div>
{% endblock %}

{% block scripts %}
    {{ super() }} <!-- Include scripts from base.html -->
    <!-- Additional scripts if necessary -->
    <script>
        function confirmDelete() {
            const checkboxes = document.querySelectorAll('input[name="sources"]:checked');
            if (checkboxes.length === 0) {
                alert('Please select at least one source to delete.');
                return false;
            }
            return confirm('Are you sure you want to delete the selected sources? This action cannot be undone.');
        }
    </script>
{% endblock %}
